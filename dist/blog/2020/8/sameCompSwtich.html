
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">

        <meta name="application name" content="sameCompSwtich.html">
        <meta name="author" content="guoqzuo">
        <meta name="description" content="在使用el-tabs时，如果涉及到同组件会打开多个tab的情况，同组件切换需要使用watch来监听数据改变，再进行数据的初始化。下面结合一个实例来看看，使用 vue + elementUI 实现在用户列表页同时打开多个用户详情页tab功能">
        <meta name="keywords" content="vue element el-tabs标签页功能demo">

        <title>vue + element实现在用户列表页同时打开多个用户详情页tab功能 - 左小白的技术日常</title>
        <link rel="shortcut icon" href="/images/favicon.ico">
        <link href="/lib/prismjs/prism_default.css" rel="stylesheet" />
        <link href="/lib/notes.css" rel="stylesheet" />
        <link rel="stylesheet" href="/lib/global.css">
        <script data-ad-client="ca-pub-9527676606416641" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      </head>
      <body>
        <header>
          <div>
            <img src="/images/logo.png" width="24" height="24" class="pointer" onclick="gotoIndex()" />
            <span class="pointer" onclick="gotoIndex()">左小白的技术日常</span>
            <span class="hidden"> | </span>
            <a href="/blog/category.html#vue" class="hidden">vue</a>
          </div>
          <div>
            
          <a href="https://www.yuque.com/guoqzuo" target="_black" class="hidden">语雀</a>
        
          <a href="https://github.com/zuoxiaobai" target="_black" class="">Github</a>
        
          </div>
        </header>
        <section class="content">
          <article>
            
    <div class="article-top">
      <div>2020/08/30</div> 
      <div class="article-top-right">Author: guoqzuo</div>
    </div>
  
            <h1 id="vue--element实现在用户列表页同时打开多个用户详情页tab功能">vue + element实现在用户列表页同时打开多个用户详情页tab功能</h1>
<p>在使用el-tabs时，如果涉及到同组件会打开多个tab的情况，同组件切换需要使用watch来监听数据改变，再进行数据的初始化</p>
<p>下面结合一个实例来看看，使用 vue + elementUI 实现在用户列表页同时打开多个用户详情页tab功能</p>
<p><img src="../../../images/blog/vue/same_comp_switch.png" alt="same_comp_switch.png"></p>
<p>目录结果如下</p>
<pre><code class="language-bash">sameCompTabs
├── comps
│   ├── UserDetail.vue # 用户详情组件
│   └── UserList.vue # 用户列表组件
└── index.vue # 入口页，el-tabs页面</code></pre>
<h2 id="tabs入口页">tabs入口页</h2>
<p>index.vue</p>
<pre><code class="language-html">&lt;template&gt;
  &lt;div class=&quot;same-comp-tabs&quot;&gt;
    curTab: {{ curTab }} curDetail: {{ curUserDetail }}

    &lt;el-tabs v-model=&quot;curTab&quot; type=&quot;card&quot; closable @tab-remove=&quot;tabRemove&quot;&gt;
      &lt;el-tab-pane
        v-for=&quot;item in tabList&quot;
        :key=&quot;item.name&quot;
        :label=&quot;item.title&quot;
        :name=&quot;item.name&quot;
      &gt;
      &lt;/el-tab-pane&gt;
    &lt;/el-tabs&gt;

    &lt;keep-alive&gt;
      &lt;component
        :is=&quot;curComp&quot;
        :detail=&quot;curUserDetail&quot;
        @open-detail=&quot;openDetail&quot;
      &gt;&lt;/component&gt;
    &lt;/keep-alive&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  components: {
    UserList: () =&gt; import(&quot;./comps/UserList&quot;),
    UserDetail: () =&gt; import(&quot;./comps/UserDetail&quot;)
  },

  computed: {
    curComp() {
      return this.curTab.split(&quot;|&quot;)[0];
    },
    curUserDetail() {
      for (let i = 0, len = this.tabList.length; i &lt; len; i++) {
        let item = this.tabList[i];
        // console.log(&quot;item&quot;, item);
        if (item.name === this.curTab &amp;&amp; item.name.includes(&quot;UserDetail&quot;)) {
          return item.detail;
        }
      }
      return {};
    }
  },

  data() {
    return {
      curTab: &quot;UserList&quot;, // v-model的值为el-tab-pane name值
      tabList: [
        {
          title: &quot;用户列表&quot;,
          name: &quot;UserList&quot;
        }
      ]
    };
  },

  methods: {
    openDetail(detail) {
      console.log(&quot;open detail in index.vue&quot;, JSON.stringify(detail));

      let name = `UserDetail|${detail.id}`;
      this.curTab = name;

      // 之前打开过
      if (this.tabList.some(item =&gt; item.name === name)) {
        return;
      }

      this.tabList.push({
        title: &quot;用户详情&quot; + detail.name,
        name,
        detail
      });
    },

    tabRemove(name) {
      console.log(&quot;remove name&quot;, name);
      if ([&quot;UserList&quot;].includes(name)) {
        return;
      }
      this.tabList = this.tabList.filter(item =&gt; item.name !== name);
      this.curTab = &quot;UserList&quot;;
    }
  }
};
&lt;/script&gt;

&lt;style lang=&quot;less&quot; scoped&gt;
.same-comp-tabs {
  padding: 20px;
}
&lt;/style&gt;
</code></pre>
<h2 id="用户列表组件">用户列表组件</h2>
<p>UserList.vue</p>
<pre><code class="language-html">&lt;template&gt;
  &lt;div&gt;
    &lt;el-table
      :data=&quot;tableData&quot;
      size=&quot;small&quot;
      height=&quot;250&quot;
      border
      style=&quot;width: 100%&quot;
    &gt;
      &lt;el-table-column prop=&quot;name&quot; label=&quot;姓名&quot; width=&quot;180&quot;&gt;&lt;/el-table-column&gt;
      &lt;el-table-column label=&quot;操作&quot; width=&quot;180&quot;&gt;
        &lt;template v-slot:default=&quot;scope&quot;&gt;
          &lt;el-button type=&quot;primary&quot; size=&quot;small&quot; @click=&quot;openDetail(scope.row)&quot;&gt;
            详情
          &lt;/el-button&gt;
        &lt;/template&gt;
      &lt;/el-table-column&gt;
    &lt;/el-table&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  data() {
    return {
      tableData: [
        { name: &quot;张三&quot;, id: &quot;zhangsan&quot; },
        { name: &quot;李四&quot;, id: &quot;lisi&quot; },
        { name: &quot;王五&quot;, id: &quot;wangwu&quot; }
      ]
    };
  },
  methods: {
    openDetail(detail) {
      console.log(JSON.stringify(detail, null, 2));
      this.$emit(&quot;open-detail&quot;, detail);
    }
  }
};
&lt;/script&gt;

&lt;style&gt;&lt;/style&gt;
</code></pre>
<h2 id="用户详情组件">用户详情组件</h2>
<p>UserDetail.vue</p>
<pre><code class="language-html">&lt;template&gt;
  &lt;!-- 用户详情页 --&gt;
  &lt;div&gt;
    &lt;h1&gt;用户详情页&lt;/h1&gt;
    &lt;div&gt;userId: {{ detail.id }} userDetail: {{ userDetail }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  props: [&quot;detail&quot;],

  data() {
    return {
      userDetail: {}
    };
  },

  created() {
    console.log(&quot;create&quot;);
    this.getDetailById();
  },

  methods: {
    getDetailById() {
      console.log(&quot;get detail by id&quot;, this.detail.id);
      this.userDetail = {
        id: this.detail.id
      };
    }
  },

  // 同组件之间的切换
  watch: {
    detail: {
      handler: function(val, oldVal) {
        console.log(
          &quot;detail change&quot;,
          JSON.stringify(val),
          JSON.stringify(oldVal)
        );
        this.getDetailById();
      },
      deep: true
    }
  }
};
&lt;/script&gt;

&lt;style&gt;&lt;/style&gt;
</code></pre>
<p>完整demo地址：<a href="https://github.com/zuoxiaobai/fedemo/tree/master/src/vuecli-demo/src/views/sameCompTabs">用户列表打开多个用户详情demo | github</a></p>

          </article>
          <aside>
            <div>
              <ul><li><span class="ul-span" data-id="vue--element实现在用户列表页同时打开多个用户详情页tab功能" style="padding-left:1em">vue + element实现在用户列表页同时打开多个用户详情页tab功能<span></li><ul><li><span class="ul-span" data-id="tabs入口页" style="padding-left:2em">tabs入口页<span></li></ul><ul><li><span class="ul-span" data-id="用户列表组件" style="padding-left:2em">用户列表组件<span></li></ul><ul><li><span class="ul-span" data-id="用户详情组件" style="padding-left:2em">用户详情组件<span></li></ul></ul>
            <div>
          </aside>
        </section>
        <footer>
          <div class="footer_content">
            <div class="footer_right">Copyright © 2016-2020 zuo11.com. <a href='http://www.beian.miit.gov.cn/'>鄂ICP备16014741号-1</a></div>
            <div>Powered by <a href='https://github.com/zuoxiaobai/zuo-blog' target='_black'>zuo-blog</a></div>
          </div>
        </footer>
        <script src="/lib/prismjs/prism_default.js"></script>
        <script src="/lib/notes.js"></script> 
        <script src="/lib/global.js"></script>
        <script>
          
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?183281668cc3440449274d1f93c04de6";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
    
        </script>
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-178732583-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-178732583-1');
</script>

      </body>
    </html>
  