
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">

        <meta name="application name" content="component_is_hooks.html">
        <meta name="author" content="guoqzuo">
        <meta name="description" content="component is hooks,component is 钩子函数,假设动态组件component使用is控制组件显示，默认显示为A组件，可以切换到B组件。问：首次进入页面以及用is切换组件时，会触发A/B组件的哪些钩子函数，加了keep-alive后呢？先给出结论 1. 如果不加keep-alive，和正常的进入页面和离开页面触发的钩子函数一致。2. 如果加了keep-alive，组件首次加载才会触发 created,mounted等钩子函数，切换时就不会触发created,mounted,beforedestroyed等，所以额外加一个activated和deactivated钩子来提示页面已切换，离开当前页面，才会销毁A/B两个组件触发beforeDestroyed和destroyed两个钩子">
        <meta name="keywords" content="component is hooks,component is 钩子函数">

        <title>component用is进行组件切换时会触发哪些钩子函数，加了keep-alive后呢？ - 左小白的技术日常</title>
        <link rel="shortcut icon" href="/images/favicon.ico">
        <link href="/lib/prismjs/prism_default.css" rel="stylesheet" />
        <link href="/lib/notes.css" rel="stylesheet" />
        <link rel="stylesheet" href="/lib/global.css">
        <script data-ad-client="ca-pub-9527676606416641" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      </head>
      <body>
        <header>
          <div>
            <img src="/images/logo.png" width="24" height="24" class="pointer" onclick="gotoIndex()" />
            <span class="pointer" onclick="gotoIndex()">左小白的技术日常</span>
            <span class="hidden"> | </span>
            <a href="/blog/category.html#vue" class="hidden">vue</a>
          </div>
          <div>
            
          <a href="https://www.yuque.com/guoqzuo" target="_black" class="hidden">语雀</a>
        
          <a href="https://github.com/zuoxiaobai" target="_black" class="">Github</a>
        
          </div>
        </header>
        <section class="content">
          <article>
            
    <div class="article-top">
      <div>2020/08/30</div> 
      <div class="article-top-right">Author: guoqzuo</div>
    </div>
  
            <h1 id="component用is进行组件切换时会触发哪些钩子函数，加了keep-alive后呢？">component用is进行组件切换时会触发哪些钩子函数，加了keep-alive后呢？</h1>
<p>假设动态组件component使用is控制组件显示，默认显示为A组件，可以切换到B组件。问：</p>
<p><strong>首次进入页面以及用is切换组件时，会触发A/B组件的哪些钩子函数，加了keep-alive后呢？</strong></p>
<p>先给出结论</p>
<ol>
<li><p>如果不加keep-alive，和正常的进入页面和离开页面触发的钩子函数一致。</p>
</li>
<li><p>如果加了keep-alive，组件首次加载才会触发 created,mounted等钩子函数，切换时就不会触发created,mounted,beforedestroyed等，所以额外加一个activated和deactivated钩子来提示页面已切换，离开当前页面，才会销毁A/B两个组件触发beforeDestroyed和destroyed两个钩子</p>
</li>
</ol>
<p>这里面涉及到一些钩子函数的触发顺序问题，我们来写详细的demo来验证下</p>
<pre><code class="language-html">&lt;!-- index.vue 主页面 --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;div&gt;当前组件{{ curComp }}&lt;/div&gt;
    &lt;el-radio v-model=&quot;curComp&quot; label=&quot;compA&quot;&gt;组件A&lt;/el-radio&gt;
    &lt;el-radio v-model=&quot;curComp&quot; label=&quot;compB&quot;&gt;组件B&lt;/el-radio&gt;
    &lt;el-button @click=&quot;gotoOtherPage&quot; size=&quot;mini&quot;&gt;离开当前页面&lt;/el-button&gt;
    &lt;div&gt;
      &lt;!-- 这里用来打开或关闭keep-alive --&gt;
      &lt;!-- &lt;keep-alive&gt; --&gt;
        &lt;component :is=&quot;curComp&quot;&gt;&lt;/component&gt;
      &lt;!-- &lt;/keep-alive&gt; --&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  components: {
    compA: () =&gt; import(&quot;./A&quot;),
    compB: () =&gt; import(&quot;./B&quot;)
  },
  data() {
    return {
      curComp: &quot;compA&quot;
    };
  },
  methods: {
    gotoOtherPage() {
      this.$router.push(&quot;/echarts&quot;);
    }
  },
  beforeCreate() {
    console.log(&quot;index beforeCreate&quot;);
  },
  created() {
    console.log(&quot;index created&quot;);
  },
  beforeMount() {
    console.log(&quot;index beforeMount&quot;);
  },
  mounted() {
    console.log(&quot;index mounted&quot;);
  },
  beforeUpdate() {
    console.log(&quot;index beforeUpdate&quot;);
  },
  updated() {
    console.log(&quot;index updated&quot;);
  },
  activated() {
    console.log(&quot;index activated&quot;);
  },
  deactivated() {
    console.log(&quot;index deactivated&quot;);
  },
  beforeDestroy() {
    console.log(&quot;index beforeDestroy&quot;);
  },
  destroyed() {
    console.log(&quot;index destroyed&quot;);
  },
  errorCaptured() {
    console.log(&quot;index errorCaptured&quot;);
  }
};
&lt;/script&gt;

&lt;style&gt;&lt;/style&gt;</code></pre>
<p>组件A.vue和B.vue代码基本一致，下面是A.vue示例，B.vue只是将A改为了B</p>
<pre><code class="language-html">&lt;!-- A.vue --&gt;
&lt;template&gt;
  &lt;div&gt;
    我是A组件内容
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  beforeCreate() {
    console.log(&quot;A beforeCreate&quot;);
  },
  created() {
    console.log(&quot;A created&quot;);
  },
  beforeMount() {
    console.log(&quot;A beforeMount&quot;);
  },
  mounted() {
    console.log(&quot;A mounted&quot;);
  },
  beforeUpdate() {
    console.log(&quot;A beforeUpdate&quot;);
  },
  updated() {
    console.log(&quot;A updated&quot;);
  },
  activated() {
    console.log(&quot;A activated&quot;);
  },
  deactivated() {
    console.log(&quot;A deactivated&quot;);
  },
  beforeDestroy() {
    console.log(&quot;A beforeDestroy&quot;);
  },
  destroyed() {
    console.log(&quot;A destroyed&quot;);
  },
  errorCaptured() {
    console.log(&quot;A errorCaptured&quot;);
  }
};
&lt;/script&gt;

&lt;style&gt;&lt;/style&gt;</code></pre>
<p>keep-alive和非keep-alive钩子函数执行对比图</p>
<table>
<thead>
<tr>
<th>类别</th>
<th>非keep-alive</th>
<th>keep-alive</th>
</tr>
</thead>
<tbody><tr>
<td>首次进入</td>
<td>index beforeCreate<br>index created<br>index beforeMount<br>index mounted<br>index beforeUpdate<br>A beforeCreate<br>A created<br>A beforeMount<br>A mounted<br>index updated<br></td>
<td>index beforeCreate<br>index created<br>index beforeMount<br>index mounted<br>index beforeUpdate<br>A beforeCreate<br>A created<br>A beforeMount<br>A mounted<br>A activated<br>index updated</td>
</tr>
<tr>
<td>切换到B组件</td>
<td>index beforeUpdate<br>A beforeDestroy<br>A destroyed<br>index updated<br>index beforeUpdate<br>B beforeCreate<br>B created<br>B beforeMount<br>B mounted<br>index updated</td>
<td>A deactivated<br>index updated<br>index beforeUpdate<br>B beforeCreate<br>B created<br>B beforeMount<br>B mounted<br>B activated<br>index updated</td>
</tr>
<tr>
<td>再切回到A组件</td>
<td>index beforeUpdate<br>A beforeCreate<br>A created<br>A beforeMount<br>B beforeDestroy<br>B destroyed<br>A mounted<br>index updated</td>
<td>index beforeUpdate<br>B deactivated<br>A activated<br>index updated</td>
</tr>
<tr>
<td>再切回B组件</td>
<td>index beforeUpdate<br>B beforeCreate<br>B created<br>B beforeMount<br>A beforeDestroy<br>A destroyed<br>B mounted<br>index updated</td>
<td>index beforeUpdate<br>A deactivated<br>B activated<br>index updated</td>
</tr>
<tr>
<td>点击离开当前页面</td>
<td>index beforeDestroy<br>B beforeDestroy<br>B destroyed<br>index destroyed</td>
<td>index beforeDestroy<br>B deactivated<br>A beforeDestroy<br>A destroyed<br>B beforeDestroy<br>B destroyed<br>index destroyed</td>
</tr>
</tbody></table>
<p>完整demo地址，参见 <a href="https://github.com/zuoxiaobai/fedemo/tree/master/src/vuecli-demo/src/views/vuehooks/">vue hooks demo | github</a></p>

          </article>
          <aside>
            <div>
              <ul><li><span class="ul-span" data-id="component用is进行组件切换时会触发哪些钩子函数，加了keep-alive后呢？" style="padding-left:1em">component用is进行组件切换时会触发哪些钩子函数，加了keep-alive后呢？<span></li></ul>
            <div>
          </aside>
        </section>
        <footer>
          <div class="footer_content">
            <div class="footer_right">Copyright © 2016-2020 zuo11.com. <a href='http://www.beian.miit.gov.cn/'>鄂ICP备16014741号-1</a></div>
            <div>Powered by <a href='https://github.com/zuoxiaobai/zuo-blog' target='_black'>zuo-blog</a></div>
          </div>
        </footer>
        <script src="/lib/prismjs/prism_default.js"></script>
        <script src="/lib/notes.js"></script> 
        <script src="/lib/global.js"></script>
        <script>
          
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?183281668cc3440449274d1f93c04de6";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
    
        </script>
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-178732583-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-178732583-1');
</script>

      </body>
    </html>
  